

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configure an Object Storage deployment &mdash; Rackspace Private Cloud 14.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/privatecloud.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'14.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: ''
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bespoke.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bolditalic.css" type="text/css" />
    <link rel="next" title="Run the Object Storage playbooks" href="ch-object-storage-playbook.html" />
    <link rel="prev" title="Create networks" href="ch-object-storage-network-planning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Rackspace Private Cloud
          

          
            
            <img src="../_static/privatecloud.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                r14-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Rackspace Private Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-faq-external/index.html">Technical FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-ironic/index.html">Bare Metal Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-appformix-external/index.html">Optimization and Visualization User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Stand-alone Object Storage for RPCO Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../common/rpc-common-front.html">Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-object-storage-overview.html">Object Storage overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-object-storage-prereqs.html">Prerequisites</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ch-object-storage-install.html">Install Object Storage</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ch_object-storage-example-install-arch.html">Example Object Storage installation architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="ch-object-storage-storage-devices.html">Configure and mount storage devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="ch-object-storage-network-planning.html">Create networks</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Configure an Object Storage deployment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#update-the-stand-alone-object-storage-configuration-files">Update the stand-alone Object Storage configuration files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allow-identity-users-to-use-object-storage">Allow Identity users to use Object Storage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ch-object-storage-playbook.html">Run the Object Storage playbooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="ch-object-storage-verifying-install.html">Verify the installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ch-object-storage-monitoring.html">Object Storage monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="app-object-storage-configfiles.html">Object Storage configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common/rpc-common-end.html">Document history and additional information</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Internal documents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rpc-faq-internal/index.html">Technical FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-install-internal/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-magnum/index.html">Magnum Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-monitoring-internal/index.html">Monitoring and Logging Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-ops-internal/index.html">Operations Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-sales-eng-internal/index.html">Rackspace Private Cloud Sales Engineering Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-upgrade-exp/index.html">Upgrade Expectations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-upgrade-internal/index.html">Upgrade Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rackspace Private Cloud</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Stand-alone Object Storage for RPCO Guide</a> &raquo;</li>
        
          <li><a href="ch-object-storage-install.html">Install Object Storage</a> &raquo;</li>
        
      <li>Configure an Object Storage deployment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/rpc-swift/ch-object-storage-configure.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configure-an-object-storage-deployment">
<span id="config-deployment"></span><h1>Configure an Object Storage deployment<a class="headerlink" href="#configure-an-object-storage-deployment" title="Permalink to this headline">#</a></h1>
<p>To configure stand-alone Object Storage for RPCO, you update the following
files:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">/etc/openstack_deploy/openstack_user_config.yml</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc/openstack_deploy/user_osa_variables_overrides.yml</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d/swift.yml</span></code></li>
</ul>
<p>For direct links to these files, see
<a class="reference internal" href="app-object-storage-configfiles.html#object-storage-configuration-files"><span class="std std-ref">Object Storage configuration files</span></a>.</p>
<div class="section" id="update-the-stand-alone-object-storage-configuration-files">
<h2>Update the stand-alone Object Storage configuration files<a class="headerlink" href="#update-the-stand-alone-object-storage-configuration-files" title="Permalink to this headline">#</a></h2>
<ol class="arabic">
<li><p class="first">In the <code class="docutils literal"><span class="pre">openstack_user_config.yml</span></code> file, set the <code class="docutils literal"><span class="pre">identity_hosts</span></code> and
<code class="docutils literal"><span class="pre">shared-infra_hosts</span></code> entries to the following values to set up the
Identity and infrastructure services. The following example shows <code class="docutils literal"><span class="pre">node1</span></code>
through <code class="docutils literal"><span class="pre">node3</span></code>. The values must be adjusted for all <code class="docutils literal"><span class="pre">identity_hosts</span></code>
and <code class="docutils literal"><span class="pre">shared-infra_hosts</span></code> entries.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># identity_hosts:</span>
<span class="c1">#   node1:</span>
<span class="c1">#     ip: 192.168.100.1</span>
<span class="c1">#   node2:</span>
<span class="c1">#     ip: 192.168.100.2</span>
<span class="c1">#   node3:</span>
<span class="c1">#     ip: 192.168.100.3</span>
<span class="c1"># shared-infra_hosts:</span>
<span class="c1">#   node1:</span>
<span class="c1">#     ip: 192.168.100.1</span>
<span class="c1">#   node2:</span>
<span class="c1">#     ip: 192.168.100.2</span>
<span class="c1">#   node3:</span>
<span class="c1">#     ip: 192.168.100.3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the <code class="docutils literal"><span class="pre">openstack_user_config.yml</span></code> file, do not set up any
<code class="docutils literal"><span class="pre">compute_hosts</span></code> or <code class="docutils literal"><span class="pre">storage_hosts</span></code> entries. When the hosts are not
set up in the <code class="docutils literal"><span class="pre">openstack_user_config.yml</span></code> file, the Ansible playbooks
do not deploy the hosts.</p>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">user_osa_variables_overrides.yml</span></code> file, update the
following user variables.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">rackspace_cloud</span></code> variables are needed only if you are using
the Rackspace Monitoring service.</p>
</div>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># container_openstack_password:</span>
<span class="c1"># keystone_auth_admin_password:</span>
<span class="c1"># keystone_auth_admin_token:</span>
<span class="c1"># keystone_container_mysql_password:</span>
<span class="c1"># keystone_service_password:</span>
<span class="c1"># memcached_encryption_key:</span>
<span class="c1"># mysql_debian_sys_maint_password:</span>
<span class="c1"># mysql_root_password:</span>
<span class="c1"># rabbitmq_cookie_token:</span>
<span class="c1"># rabbitmq_password:</span>
<span class="c1"># rackspace_cloud_api_key:</span>
<span class="c1"># rackspace_cloud_auth_url:</span>
<span class="c1"># rackpace_cloud_password:</span>
<span class="c1"># rackspace_cloud_tenant_id:</span>
<span class="c1"># rackspace_cloud_username:</span>
<span class="c1"># rackspace_cloudfiles_tenant_id:</span>
<span class="c1"># rpc_support_holland_password:</span>
<span class="c1"># swift_container_mysql_password:</span>
<span class="c1"># swift_hash_path_prefix:</span>
<span class="c1"># swift_hash_path_suffix:</span>
<span class="c1"># swift_service_password:</span>
<span class="c1"># swift_dispersion_user:</span>
<span class="c1"># swift_dispersion_password:</span>
<span class="c1"># service_syslog:</span>
<span class="c1"># galera_root_password:</span>
</pre></div>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d/swift.yml</span></code> file, update the
<code class="docutils literal"><span class="pre">global_overrides</span></code> values as shown in the following example. The
parameters are explained following the example.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># global_overrides:</span>
<span class="c1">#   swift:</span>
<span class="c1">#     part_power: 8</span>
<span class="c1">#     weight: 100</span>
<span class="c1">#     min_part_hours: 1</span>
<span class="c1">#     repl_number: 3</span>
<span class="c1">#     storage_network: &#39;br-storage&#39;</span>
<span class="c1">#     replication_network: &#39;br-repl&#39;</span>
<span class="c1">#     drives:</span>
<span class="c1">#       - name: sdc</span>
<span class="c1">#       - name: sdd</span>
<span class="c1">#       - name: sde</span>
<span class="c1">#       - name: sdf</span>
<span class="c1">#     mount_point: /mnt</span>
<span class="c1">#     account:</span>
<span class="c1">#     container:</span>
<span class="c1">#     storage_policies:</span>
<span class="c1">#       - policy:</span>
<span class="c1">#           name: gold</span>
<span class="c1">#           index: 0</span>
<span class="c1">#           default: True</span>
<span class="c1">#       - policy:</span>
<span class="c1">#           name: silver</span>
<span class="c1">#           index: 1</span>
<span class="c1">#           repl_number: 3</span>
<span class="c1">#           deprecated: True</span>
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">part_power</span></code></dt>
<dd><p class="first">Set the partition power value based on the total amount of
storage that the entire ring will use.</p>
<p class="last">Multiply the maximum number of drives used with this Object
Storage installation by 100 and round that value up to the
closest power of 2 value. For example, a maximum of 6 drives,
times 100, equals 600. The nearest power of 2 above 600 is 2
to the power of 9, so the partition power is 9. The
partition power can&#8217;t be changed after the Object Storage rings
are built.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">weight</span></code></dt>
<dd><p class="first last">The default weight is 100. If the drives are different sizes, set
the weight value to avoid uneven distribution of data. For
example, a 1 TB disk would have a weight of 100, while a 2 TB
drive would have a weight of 200.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">min_part_hours</span></code></dt>
<dd><p class="first">The default value is 1. Set the minimum partition hours to the
amount of time to lock a partition&#8217;s replicas after a partition
has been moved. Moving multiple replicas at the same time might
make data inaccessible. This value can be set separately in the
<code class="docutils literal"><span class="pre">swift</span></code>, <code class="docutils literal"><span class="pre">container</span></code>, <code class="docutils literal"><span class="pre">account</span></code>, and <code class="docutils literal"><span class="pre">policy</span></code> sections,
with the value in other sections superseding the value in the
<code class="docutils literal"><span class="pre">swift</span></code> section.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For account and container rings, <code class="docutils literal"><span class="pre">min_part_hours</span></code> and
<code class="docutils literal"><span class="pre">repl_number</span></code> are the only values that can be set. Setting them
in this section overrides the defaults for the specific ring.</p>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">repl_number</span></code></dt>
<dd><p class="first">The default value is 3. Set the replication number to the number
of replicas of each object. This value can be set separately in
the <code class="docutils literal"><span class="pre">swift</span></code>, <code class="docutils literal"><span class="pre">container</span></code>, <code class="docutils literal"><span class="pre">account</span></code>, and <code class="docutils literal"><span class="pre">policy</span></code> sections,
with the value in the other sections superseding the value in the
<code class="docutils literal"><span class="pre">swift</span></code> section.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For account and container rings, <code class="docutils literal"><span class="pre">min_part_hours</span></code> and
<code class="docutils literal"><span class="pre">repl_number</span></code> are the only values that can be set. Setting them
in this section overrides the defaults for the specific ring.</p>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">storage_network</span></code></dt>
<dd><p class="first">By default, the swift services will listen on the default
management IP address. Optionally, specify the interface of the storage
network.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the <code class="docutils literal"><span class="pre">storage_network</span></code> value is not set, but the <code class="docutils literal"><span class="pre">storage_ips</span></code>
value per host is set (or the <code class="docutils literal"><span class="pre">storage_ips</span></code> value is not set on the
storage network interface), the proxy server can&#8217;t connect to the
storage services.</p>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">replication_network</span></code></dt>
<dd><p class="first">Optionally, specify a dedicated replication network interface, so
dedicated replication can be set up. If this value is not
specified, no dedicated replication network is set.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Replication does not work properly if the <code class="docutils literal"><span class="pre">repl_ip</span></code> is not able
to connect to other hosts&#8217; <code class="docutils literal"><span class="pre">repl_ip</span></code>.</p>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">drives</span></code></dt>
<dd><p class="first last">Set the default drives per host. This is useful when all hosts
have the same drives. These values can be overridden for each host.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">mount_point</span></code></dt>
<dd><p class="first last">Set the <code class="docutils literal"><span class="pre">mount_point</span></code> value to the location where the swift
drives are mounted. For example, with a mount point of <code class="docutils literal"><span class="pre">/mnt</span></code>
and a drive of <code class="docutils literal"><span class="pre">sdc</span></code>, a drive is mounted at <code class="docutils literal"><span class="pre">/mnt/sdc</span></code> on the
swift host. This value can be overridden for each host.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">storage_policies</span></code></dt>
<dd><p class="first last">Storage policies determine on which hardware data is stored, how
the data is stored across that hardware, and in which region the
data resides. Each storage policy must have an unique <code class="docutils literal"><span class="pre">name</span></code>
and a unique <code class="docutils literal"><span class="pre">index</span></code> value. There must be a storage policy with an
index of 0 in the <code class="docutils literal"><span class="pre">swift.yml</span></code> file to use any legacy containers
created before storage policies were instituted.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">default</span></code></dt>
<dd><p class="first last">Set the <code class="docutils literal"><span class="pre">default</span></code> value to <code class="docutils literal"><span class="pre">yes</span></code> for at least one policy. This policy
is the default storage policy for any non-legacy containers that are
created.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">deprecated</span></code></dt>
<dd><p class="first last">Set the <code class="docutils literal"><span class="pre">deprecated</span> <span class="pre">``value</span> <span class="pre">to</span> <span class="pre">``yes</span></code> to turn off storage policies.</p>
</dd>
</dl>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d/swift.yml</span></code> file, update the Object
Storage proxy hosts values by setting the IP address of the hosts to which
Ansible will connect to deploy the swift-proxy containers. The
<code class="docutils literal"><span class="pre">swift-proxy_hosts</span></code> value should match the infra nodes.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># swift-proxy_hosts:</span>
<span class="c1">#   infra-node1:</span>
<span class="c1">#     ip: 192.0.2.1</span>
<span class="c1">#   infra-node2:</span>
<span class="c1">#     ip: 192.0.2.2</span>
<span class="c1">#   infra-node3:</span>
<span class="c1">#     ip: 192.0.2.3</span>
</pre></div>
</div>
</li>
<li><p class="first">(<em>Optional</em>) In the <code class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d/swift.yml</span></code> file, update
the Object Storage hosts values as shown in the following example. The
parameters are explained following the example.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># swift_hosts:</span>
<span class="c1">#   swift-node1:</span>
<span class="c1">#     ip: 192.0.2.4</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         zone: 0</span>
<span class="c1">#   swift-node2:</span>
<span class="c1">#     ip: 192.0.2.5</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         zone: 1</span>
<span class="c1">#   swift-node3:</span>
<span class="c1">#     ip: 192.0.2.6</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         zone: 2</span>
<span class="c1">#   swift-node4:</span>
<span class="c1">#     ip: 192.0.2.7</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         zone: 3</span>
<span class="c1">#   swift-node5:</span>
<span class="c1">#     ip: 192.0.2.8</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         storage_ip: 198.51.100.8</span>
<span class="c1">#         repl_ip: 203.0.113.8</span>
<span class="c1">#         zone: 4</span>
<span class="c1">#         region: 3</span>
<span class="c1">#         weight: 200</span>
<span class="c1">#         groups:</span>
<span class="c1">#           - account</span>
<span class="c1">#           - container</span>
<span class="c1">#           - silver</span>
<span class="c1">#         drives:</span>
<span class="c1">#           - name: sdb</span>
<span class="c1">#             weight: 75</span>
<span class="c1">#             groups:</span>
<span class="c1">#               - gold</span>
<span class="c1">#           - name: sdc</span>
<span class="c1">#           - name: sdd</span>
<span class="c1">#           - name: sde</span>
<span class="c1">#           - name: sdf</span>
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">swift_hosts</span></code></dt>
<dd><p class="first last">Specify the hosts to be used as the storage nodes. The <code class="docutils literal"><span class="pre">ip</span></code> value is
the address of the host to which Ansible connects. Set the name
and IP address of each Object Storage host. The <code class="docutils literal"><span class="pre">swift_hosts</span></code>
section is not required.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">swift_vars</span></code></dt>
<dd><p class="first last">Contains the values specific to the Object Storage hosts.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">storage_ip</span></code> and <code class="docutils literal"><span class="pre">repl_ip</span></code></dt>
<dd><p class="first last">These values are based on the IP addresses of the host&#8217;s
storage network or replication network. For example, if
the storage_network is <code class="docutils literal"><span class="pre">br-storage</span></code> and <code class="docutils literal"><span class="pre">node1</span></code> has an IP
address of 1.1.1.1 on <code class="docutils literal"><span class="pre">br-storage</span></code>, then that IP address is used for
the <code class="docutils literal"><span class="pre">storage_ip</span></code> value. If only the <code class="docutils literal"><span class="pre">storage_ip</span></code> value
is specified, the <code class="docutils literal"><span class="pre">repl_ip</span></code> value defaults to the <code class="docutils literal"><span class="pre">storage_ip</span></code> value.
If neither are specified, both default to the host IP address.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">zone</span></code></dt>
<dd><p class="first last">The default is <code class="docutils literal"><span class="pre">0</span></code>. Optionally, set the Object Storage zone for the
ring.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">region</span></code></dt>
<dd><p class="first last">Optionally, set the Object Storage region for the ring.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">weight</span></code></dt>
<dd><p class="first last">The default weight is <code class="docutils literal"><span class="pre">100</span></code>. If the drives are different sizes, set
the weight value to avoid uneven distribution of data. You can specify
this value on a host or drive basis (if specified on both,
the drive setting takes precedence).</p>
</dd>
<dt><code class="docutils literal"><span class="pre">groups</span></code></dt>
<dd><p class="first last">Set this value to list the rings to which a host&#8217;s drive belongs.
You can set this value on a per-drive basis, which overrides the host
setting.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">drives</span></code></dt>
<dd><p class="first last">Set the names of the drives on this Object Storage host. At least
one name must be specified.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">weight</span></code></dt>
<dd><p class="first last">The default weight is <code class="docutils literal"><span class="pre">100</span></code>. If the drives are different sizes, set
the weight value to avoid uneven distribution of data. You can specify
this value on a host or drive basis (if specified on both,
the drive setting takes precedence).</p>
</dd>
</dl>
<p>In the following example, <code class="docutils literal"><span class="pre">swift-node5</span></code> shows values in the
<code class="docutils literal"><span class="pre">swift_hosts</span></code> section that override the global values. Groups
are set, which overrides the global settings for drive <code class="docutils literal"><span class="pre">sdb</span></code>. The
weight is overridden for the host and specifically adjusted for drive
<code class="docutils literal"><span class="pre">sdb</span></code>.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1">#  swift-node5:</span>
<span class="c1">#     ip: 192.0.2.8</span>
<span class="c1">#     container_vars:</span>
<span class="c1">#       swift_vars:</span>
<span class="c1">#         storage_ip: 198.51.100.8</span>
<span class="c1">#         repl_ip: 203.0.113.8</span>
<span class="c1">#         zone: 4</span>
<span class="c1">#         region: 3</span>
<span class="c1">#         weight: 200</span>
<span class="c1">#         groups:</span>
<span class="c1">#           - account</span>
<span class="c1">#           - container</span>
<span class="c1">#           - silver</span>
<span class="c1">#         drives:</span>
<span class="c1">#           - name: sdb</span>
<span class="c1">#             weight: 75</span>
<span class="c1">#             groups:</span>
<span class="c1">#               - gold</span>
<span class="c1">#           - name: sdc</span>
<span class="c1">#           - name: sdd</span>
<span class="c1">#           - name: sde</span>
<span class="c1">#           - name: sdf</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify that the <code class="docutils literal"><span class="pre">swift.yml</span></code> file is in the
<code class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d/</span></code> folder.</p>
</li>
<li><p class="first">(<em>Optional</em>) If you are using the built-in HAProxy as the load balancer, add
the following variables to the <code class="docutils literal"><span class="pre">user_osa_variables_overrides.yml</span></code> file to
ensure that only the appropriate load balancer endpoints are set.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># haproxy_service_configs:</span>
<span class="c1">#  - service:</span>
<span class="c1">#      haproxy_service_name: repo_all</span>
<span class="c1">#      haproxy_backend_nodes: &quot;{{ groups[&#39;pkg_repo&#39;] }}&quot;</span>
<span class="c1">#      haproxy_port: 8181#</span>
<span class="c1">#      haproxy_backend_port: 8181</span>
<span class="c1">#      haproxy_balance_type: http</span>
<span class="c1">#  - service:</span>
<span class="c1">#      haproxy_service_name: galera</span>
<span class="c1">#      haproxy_backend_nodes: &quot;{{ [groups[&#39;galera_all&#39;][0]] }}&quot;  # list</span>
<span class="c1">#        expected</span>
<span class="c1">#      haproxy_backup_nodes: &quot;{{ groups[&#39;galera_all&#39;][1:] }}&quot;</span>
<span class="c1">#      haproxy_port: 3306</span>
<span class="c1">#      haproxy_balance_type: tcp</span>
<span class="c1">#      haproxy_timeout_client: 5000s</span>
<span class="c1">#      haproxy_timeout_server: 5000s</span>
<span class="c1">#      haproxy_backend_options:</span>
<span class="c1">#        - &quot;mysql-check user {{ galera_monitoring_user }}&quot;</span>
<span class="c1">#  - service:</span>
<span class="c1">#      haproxy_service_name: swift_proxy</span>
<span class="c1">#      haproxy_backend_nodes: &quot;{{ groups[&#39;swift_proxy&#39;] }}&quot;</span>
<span class="c1">#      haproxy_balance_alg: source</span>
<span class="c1">#      haproxy_port: 8080</span>
<span class="c1">#      haproxy_balance_type: http</span>
<span class="c1">#  - service:</span>
<span class="c1">#      haproxy_service_name: keystone_admin</span>
<span class="c1">#      haproxy_backend_nodes: &quot;{{ groups[&#39;keystone_all&#39;] }}&quot;</span>
<span class="c1">#      haproxy_port: 35357</span>
<span class="c1">#      haproxy_balance_type: http</span>
<span class="c1">#      haproxy_backend_options:</span>
<span class="c1">#       - &quot;forwardfor&quot;</span>
<span class="c1">#       - &quot;httpchk&quot;</span>
<span class="c1">#       - &quot;httplog&quot;</span>
<span class="c1">#  - service:</span>
<span class="c1">#      haproxy_service_name: keystone_service</span>
<span class="c1">#      haproxy_backend_nodes: &quot;{{ groups[&#39;keystone_all&#39;] }}&quot;</span>
<span class="c1">#      haproxy_port: 5000</span>
<span class="c1">#      haproxy_balance_type: http</span>
<span class="c1">#      haproxy_backend_options:</span>
<span class="c1">#       - &quot;forwardfor&quot;</span>
<span class="c1">#       - &quot;httpchk&quot;</span>
<span class="c1">#       - &quot;httplog&quot;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="allow-identity-users-to-use-object-storage">
<h2>Allow Identity users to use Object Storage<a class="headerlink" href="#allow-identity-users-to-use-object-storage" title="Permalink to this headline">#</a></h2>
<p>Users with the <code class="docutils literal"><span class="pre">_member_</span></code> role are authorized Identity (keystone)
users. You can allow these users to create containers and upload
objects to Object Storage by opening the
<code class="docutils literal"><span class="pre">user_osa_variables_overrides.yml</span></code> file for editing and setting
<code class="docutils literal"><span class="pre">swift_allow_all_users</span></code> to <code class="docutils literal"><span class="pre">True</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If this value is <code class="docutils literal"><span class="pre">False</span></code>, then by default, only users with the
<code class="docutils literal"><span class="pre">admin</span></code> or <code class="docutils literal"><span class="pre">swiftoperator</span></code> role are allowed to create containers or
manage projects.</p>
</div>
<p>When the back-end type for the Image service (glance) is set to
<code class="docutils literal"><span class="pre">swift</span></code>, the Image service can access the Object Storage cluster
regardless of whether this value is <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ch-object-storage-playbook.html" class="btn btn-neutral float-right" title="Run the Object Storage playbooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ch-object-storage-network-planning.html" class="btn btn-neutral float-left" title="Create networks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Rackspace

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>