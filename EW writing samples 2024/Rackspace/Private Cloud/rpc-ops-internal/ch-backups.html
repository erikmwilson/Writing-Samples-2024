

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Backups &mdash; Rackspace Private Cloud 14.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/privatecloud.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'14.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: ''
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bespoke.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bolditalic.css" type="text/css" />
    <link rel="next" title="Document history and additional information" href="postface.html" />
    <link rel="prev" title="Load-Balancer-as-a-Service (LBaaS)" href="ch-lbaas.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Rackspace Private Cloud
          

          
            
            <img src="../_static/privatecloud.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                r14-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Rackspace Private Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-faq-external/index.html">Technical FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-ironic/index.html">Bare Metal Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-appformix-external/index.html">Optimization and Visualization User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-swift/index.html">Stand-alone Object Storage for RPCO Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Internal documents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rpc-faq-internal/index.html">Technical FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-install-internal/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-magnum/index.html">Magnum Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-monitoring-internal/index.html">Monitoring and Logging Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Operations Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-verify.html">Verifying cloud deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-access.html">Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-instances.html">Instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-images.html">Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-compute.html">Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-galera.html">Managing Galera clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-ceph.html">RPC Ceph operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-swift.html">Managing Object Storage for multiple regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-containers.html">Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch-lbaas.html">Load-Balancer-as-a-Service (LBaaS)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Backups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#backups-for-running-volumes">Backups for running volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backups-in-customer-data-centers">Backups in Customer data centers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backups-in-rackspace-data-centers">Backups in Rackspace data centers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#contents-of-backups">Contents of backups</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backup-configuration">Backup configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-mbu-ticket">Creating an MBU ticket</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requesting-a-restore-from-mbu">Requesting a restore from MBU</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postface.html">Document history and additional information</a></li>
<li class="toctree-l2"><a class="reference internal" href="postface.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-sales-eng-internal/index.html">Rackspace Private Cloud Sales Engineering Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-upgrade-exp/index.html">Upgrade Expectations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc-upgrade-internal/index.html">Upgrade Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rackspace Private Cloud</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Operations Guide</a> &raquo;</li>
        
      <li>Backups</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/rpc-ops-internal/ch-backups.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="backups">
<h1>Backups<a class="headerlink" href="#backups" title="Permalink to this headline">#</a></h1>
<div class="section" id="backups-for-running-volumes">
<h2>Backups for running volumes<a class="headerlink" href="#backups-for-running-volumes" title="Permalink to this headline">#</a></h2>
<p>A non-intrusive backup option allows backups for running volumes that
are currently in use by an instance. Users no longer need to wait for
volumes to move into an available state before completing
a backup. This option represents an alternative to the method of
creating a backup based on a clone of a volume.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Set the <code class="docutils literal"><span class="pre">--force</span></code> flag to <code class="docutils literal"><span class="pre">TRUE</span></code> in the <code class="docutils literal"><span class="pre">cinder.conf</span></code> file
to enable backups of in-use volumes. Cinder will reject the
request if this variable remains blank or set to <code class="docutils literal"><span class="pre">FALSE</span></code>.</p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Ensure that the <code class="docutils literal"><span class="pre">backup_use_temp_snapshot</span></code> option is set to <code class="docutils literal"><span class="pre">TRUE</span></code>
in the <code class="docutils literal"><span class="pre">cinder.conf</span></code> file on any Cinder Drivers that implement
snapshot attachment.</p>
</li>
<li><p class="first">Execute the <code class="docutils literal"><span class="pre">cinder</span> <span class="pre">backup-create</span></code> command with <code class="docutils literal"><span class="pre">--incremental</span></code>
and <code class="docutils literal"><span class="pre">--force</span></code> arguments. Ensure the volume name is included in
this command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> cinder backup-create --incremental --force &lt;volume name&gt;
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="backups-in-customer-data-centers">
<h2>Backups in Customer data centers<a class="headerlink" href="#backups-in-customer-data-centers" title="Permalink to this headline">#</a></h2>
<p>Customers are responsible for backing up data when hosted in their data
centers. Back up the following directories:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">/openstack/backup</span></code>: The data inside the containers, including the
Galera database.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">/opt</span></code>: The Ansible source code.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">/etc</span></code>: The Ansible and host configurations.</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Failure to periodically back up these directories can result in
irrecoverable data loss and inability to manage the environment.</p>
</div>
</div></blockquote>
</li>
</ul>
<p>To enable the recovery of instance data, back up the Glance backend. It
is recommended to set an automatic snapshot schedule for instances and
set the scheduler to delete old snapshots. If you use Cinder volumes,
also back up that data.</p>
<p>Comprehensive backups are an important part of disaster planning.
Include planning for Netapp, NFS shares, or Cloud Files if used. For
example, Netapp uses <code class="docutils literal"><span class="pre">/var/lib/glance/</span></code> for the image store.</p>
</div>
<div class="section" id="backups-in-rackspace-data-centers">
<h2>Backups in Rackspace data centers<a class="headerlink" href="#backups-in-rackspace-data-centers" title="Permalink to this headline">#</a></h2>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is for Rackspace only, and does not appear in the
customer-facing version of the document.</p>
</div>
</div></blockquote>
<p>Rackspace manages backups for Core Support customers when their clouds
are hosted in Rackspace data centers. Backups must be configured after
the cloud setup is complete. This section documents the contents and
configuration for Rackspace backups.</p>
<div class="section" id="contents-of-backups">
<h3>Contents of backups<a class="headerlink" href="#contents-of-backups" title="Permalink to this headline">#</a></h3>
<p>The following information is backed up:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">/openstack/backup</span></code>: The data inside the containers, including the
Galera database.</li>
<li><code class="docutils literal"><span class="pre">/opt</span></code>: The Ansible source code.</li>
<li><code class="docutils literal"><span class="pre">/etc</span></code>: The Ansible and host configurations.</li>
</ul>
<p>Glance images are not included in these backups, since they are no
longer included on infrastructure nodes. Instead, glance images may be
hosted in Cloud Files, a local OpenStack Object Storage cloud, or in
NetApp. Regardless of glance back-end, ensure that customer expectations
are clear regarding the lifespan and backup of images.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Elasticsearch is not currently backed up. Refer to
<a class="reference external" href="https://bugs.launchpad.net/openstack-ansible/+bug/1400440">openstack-ansible bug 1400440</a>
for more information.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="backup-configuration">
<h3>Backup configuration<a class="headerlink" href="#backup-configuration" title="Permalink to this headline">#</a></h3>
<p>Host backup configuration is executed by the Ansible playbooks. The
playbooks configure a cron job, which generates a file dump onto the
host devices that contains the data that needs to be backed up.</p>
<p>Each container includes a backup directory called <code class="docutils literal"><span class="pre">/var/backup</span></code>. This
directory is bind-mounted to the <code class="docutils literal"><span class="pre">/openstack/backup/container_name</span></code>
directory on the host. Backing up the complete <code class="docutils literal"><span class="pre">/openstack/backup</span></code>
directory ensures that all relevant container data is included.</p>
<p>You must configure the ServiceNet IP address route from CORE as a static
route.</p>
</div>
<div class="section" id="creating-an-mbu-ticket">
<h3>Creating an MBU ticket<a class="headerlink" href="#creating-an-mbu-ticket" title="Permalink to this headline">#</a></h3>
<p>When the environment is ready, send a ticket to Rackspace MBU with the
name of the primary infrastructure node. Use the following template:</p>
<blockquote>
<div><div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">MBU,</span>

<span class="na">This is to configure the backup for a RPCO vV.n.n deployment.</span>

<span class="na">Please install the MBU software on device device_name. This device is</span>
<span class="na">running Ubuntu 16.04 LTS.</span>

<span class="na">Please set the Save Set to the following:</span>

<span class="na">/openstack/backup/*</span>

<span class="na">/etc/*</span>

<span class="na">/opt/*</span>

<span class="na">Please install the commvault packages on this device.</span>

<span class="na">Thanks!</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="requesting-a-restore-from-mbu">
<h3>Requesting a restore from MBU<a class="headerlink" href="#requesting-a-restore-from-mbu" title="Permalink to this headline">#</a></h3>
<p>When data needs to be restored on a host, send a ticket to MBU. The
ticket must include the following information:</p>
<ul>
<li><p class="first">Server name</p>
</li>
<li><p class="first">Date of data</p>
</li>
<li><p class="first">Exact path of the data that needs to be restored</p>
</li>
<li><p class="first">Location where the data should be restored to</p>
<p>If a location is not provided, one of the following defaults will be
used:</p>
<p><code class="docutils literal"><span class="pre">drive_letter:\rs-pkgs\restore_ticket_number</span></code></p>
<p>or</p>
<p><code class="docutils literal"><span class="pre">/home/rack/restore_ticket-number</span></code></p>
</li>
<li><p class="first">Any special instructions</p>
<p>For example: &#8220;Replay transaction logs; wait until 6pm CST to start
the restore process; call upon completion&#8221;.</p>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="postface.html" class="btn btn-neutral float-right" title="Document history and additional information" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ch-lbaas.html" class="btn btn-neutral float-left" title="Load-Balancer-as-a-Service (LBaaS)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Rackspace

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>